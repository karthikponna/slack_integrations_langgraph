{
    "id": "cc2e9cae04b645d60413fc2cce3c97bb",
    "metadata": {
        "id": "cc2e9cae04b645d60413fc2cce3c97bb",
        "url": "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/best-practices-upgrading-zenml",
        "title": "Best practices for upgrading | ZenML - Bridging the gap between ML & Ops",
        "properties": {
            "description": "Simple, step-by-step guide for keeping your ZenML workspaces (servers) up to date without breaking your teams.",
            "keywords": null,
            "author": null,
            "og:title": "Best practices for upgrading | ZenML - Bridging the gap between ML & Ops",
            "og:description": "Simple, step-by-step guide for keeping your ZenML workspaces (servers) up to date without breaking your teams.",
            "og:image": "https://docs.zenml.io/~gitbook/ogimage/QSlBkpMj7bANbLtrHWBV",
            "twitter:card": "summary_large_image",
            "twitter:title": "Best practices for upgrading | ZenML - Bridging the gap between ML & Ops",
            "twitter:description": "Simple, step-by-step guide for keeping your ZenML workspaces (servers) up to date without breaking your teams.",
            "twitter:image": "https://docs.zenml.io/~gitbook/ogimage/QSlBkpMj7bANbLtrHWBV"
        }
    },
    "content": "`‚åò``k`\nGitBook Assistant\nProductResourcesGitHubStart free\nMore\n  * Documentation\n  * Learn\n  * ZenML Pro\n  * Stacks\n  * API Reference\n  * SDK Reference\n  * Changelog\n\n\nGitBook Assistant\nGitBook Assistant\nWorking...Thinking...\nGitBook Assistant\n##### Good afternoon\nI'm here to help you with the docs.\nWhat is this page about?What should I read next?Can you give an example?\n`‚åò``i`\nAI Based on your context\nSend\n  * Getting Started\n    *     *     *     *     *     *   * Deploying ZenML\n    *     *     *       * Best practices for upgrading\n      * Using ZenML server in production\n      * Troubleshoot your ZenML server\n      * Migration guide\n  * Concepts\n    *     *     *     *     *     *     *     *     *     *     *     *     *     *     *   * Reference\n    *     *     *     *     *     * \n\nPowered by GitBook\n  * ‚òùÔ∏è Step #1: Always Use Two Environments\n  * üß± Step #2: Mirror Your Stacks in Both Environments\n  * üõ†Ô∏è Step #3: Use GitOps to Manage Upgrades\n  * ü§ù Step #4: Run a test suite in staging\n  * üîÑ Step #5: Update all snapshots\n  * üöÄ Step #6: Upgrade Production and Go Live\n  * Ops Notes (OSS only)\n  * ‚úÖ Summary: The Upgrade Flow\n  * üîö Final Notes\n\n\nWas this helpful?\nGitBook AssistantAsk\n  1. Deploying ZenML\n  2. \n\n# Best practices for upgrading\nSimple, step-by-step guide for keeping your ZenML workspaces (servers) up to date without breaking your teams.\nUpgrading ZenML doesn't have to be scary.\nWhether you're using the open-source (OSS) version or ZenML Pro (where servers are called _workspaces_), this guide will help you set up a clean, testable, and stress-free upgrade process using a production + staging pattern.\n  1. Always have **two environments** : _production_ and _staging_.\n  2. Mirror everything in both places.\n  3. Use GitOps to automate upgrades.\n  4. Run the right tests in staging.\n  5. Re-create snapshots.\n  6. Cut over to production once staging is green.\n\n\nThat's it. The rest of this chapter just fills in the details.\n## \n‚òùÔ∏è Step #1: Always Use Two Environments\nWhether you're OSS or Pro:\n  * You should **always have two environments** :\n    * **Production** ‚Äî where your team builds and runs real pipelines.\n    * **Staging** ‚Äî used _only_ to test ZenML upgrades before they hit production.\n\n\n> üè¢ **ZenML Pro** users: use **two workspaces** (e.g. `prod-workspace`, `staging-workspace`) üíª **ZenML OSS** users: run **two ZenML servers** (same logic applies)\nDiagram showing \"Production\" and \"Staging\" environments side by side. Arrows show pipelines running in production, while staging is used for upgrades only.\n## \nüß± Step #2: Mirror Your Stacks in Both Environments\nAt setup time:\n  * For every **stack in production** , create a **mirrored stack in staging**\n  * Ideally, they point to **separate infra** , but can also share infra if needed\n\n\nStack Component\nProduction\nStaging\nKubernetes cluster\n`prod-k8s-cluster`\n`staging-k8s-cluster`\nArtifact store\n`s3://prod-bucket`\n`s3://staging-bucket`\nContainer registry\n`gcr.io/prod-images`\n`gcr.io/staging-images`\nDiagram: Mirrored stacks pointing at separate staging infra\n  * Point staging stacks to **staging variants** of your infra (e.g., a smaller K8s cluster, a test S3 bucket).\n  * When you change a stack in production, immediately update the twin in staging.\n\n\n## \nüõ†Ô∏è Step #3: Use GitOps to Manage Upgrades\nDiagram: GitOps\nPut your workspace configuration in a Git repository (Helm charts, Terraform, or the ZenML Pro API ‚Äì pick your tool). Set up two long-lived branches:\n  * `staging` ‚Äì auto-deploys to the **staging workspace**\n  * `main` ‚Äì auto-deploys to **production**\n\n\nZenML Pro users can call the Workspace API from CI to bump the version. OSS users typically re-deploy the Helm chart/Docker image with the new tag.\n## \nü§ù Step #4: Run a test suite in staging\nAfter upgrading staging, assume things might break ‚Äî this is normal and expected.\nAt this point, the platform and data science / ML engineering teams should have mutually:\n  * Agree on a smoke test suite of pipelines or steps\n  * Maintain shared expectations on what counts as \"upgrade success\"\n\n\nFor example, the data science repo could contain a test suite that does the following checks:\nCopy```\ndef test_artifact_loading():\n    artifact = Client().get_artifact_version(\"xyz\").load()\n    assert artifact is not None\ndef test_simple_pipeline():\n    run = run_pipeline(pipeline_name=\"...\")\n    assert run.status == \"COMPLETED\"\n```\n\n## \nüîÑ Step #5: Update all snapshots\nPipeline snapshots may now break as they have the older version of the ZenML client installed. Therefore, you would need to rebuild the snapshot and associated images.\nThe easiest way to do this is to re-create a snapshot using the CLI:\nCopy```\nzenml pipeline snapshot create run.my_pipeline \\\n  --name upgraded-template \\\n  --stack staging-stack \\\n  --config configs/run.yaml\n```\n\nRead about how snapshots work.\nAfter building, execute all snapshots end-to-end as a smoke test. Ideally, your data science teams have a \"smoke test\" parameter in the pipeline to load mock data just for this scenario!\n## \nüöÄ Step #6: Upgrade Production and Go Live\nOnce staging is ‚úÖ :\n  1. Merge `staging` ‚ûú `main`.\n  2. CI upgrades the production workspace.\n  3. Immediately:\n     * Rebuild **all snapshots** in prod\n     * **Reschedule** recurring pipelines (delete old schedules, create new ones). Read more here\n  4. Monitor for a few hours. Done.\n\n\nFrom staging to production\n## \nOps Notes (OSS only)\nIf you self-host the ZenML server:\n  * Take a **database backup** before every upgrade.\n  * Keep the old Docker image tag handy for rollbacks.\n  * Store logs from the migration job.\n\n\nZenML Pro SaaS handles all of the above for you.\n## \n‚úÖ Summary: The Upgrade Flow\nCopy```\n     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n     ‚îÇ Git PR to dev ‚îÇ\n     ‚îÇ ‚Üí staging env ‚îÇ\n     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò\n            ‚îÇ\n            ‚ñº\n   Upgrade staging server\n            ‚îÇ\n       Run all pipelines / tests\n            ‚îÇ\n     ‚úî All tests pass?\n        /               \\\n      Yes                 No\n      |                    |\nRecreate snapshots        Fix\n     ‚îÇ\nUpgrade prod\n     |\n Rebuild & reschedule\n\n```\n\n  * Two workspaces keep upgrades safe.\n  * GitOps makes them repeatable.\n  * A simple pipeline test suite keeps you honest.\n\n\nUpgrade with confidence üöÄ.\n## \nüîö Final Notes\nZenML Pro: Hosted workspaces are upgraded automatically, but you still need to test your pipelines in staging before changes hit production.\nZenML OSS: You are responsible for upgrades, backups, and reconfiguration ‚Äî this guide helps you minimize downtime and bugs.\nPreviousManageNextUsing ZenML server in production\nLast updated 2 months ago\nWas this helpful?\nThis site uses cookies to deliver its service and to analyze traffic. By browsing this site, you accept the privacy policy.\nAcceptReject\n",
    "summary": null,
    "content_quality_score": null,
    "child_urls": [
        "https://docs.zenml.io/",
        "https://zenml.io",
        "https://zenml.io/slack",
        "https://cloud.zenml.io/signup",
        "https://docs.zenml.io/user-guides",
        "https://docs.zenml.io/pro",
        "https://docs.zenml.io/stacks",
        "https://docs.zenml.io/api-reference",
        "https://docs.zenml.io/sdk-reference",
        "https://docs.zenml.io/changelog",
        "https://docs.zenml.io/getting-started/installation",
        "https://docs.zenml.io/getting-started/hello-world",
        "https://docs.zenml.io/getting-started/your-first-ai-pipeline",
        "https://docs.zenml.io/getting-started/core-concepts",
        "https://docs.zenml.io/getting-started/system-architectures",
        "https://docs.zenml.io/deploying-zenml/deploying-zenml",
        "https://docs.zenml.io/deploying-zenml/connecting-to-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/best-practices-upgrading-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/using-zenml-server-in-prod",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/troubleshoot-your-deployed-server",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server/migration-guide",
        "https://docs.zenml.io/concepts/steps_and_pipelines",
        "https://docs.zenml.io/concepts/artifacts",
        "https://docs.zenml.io/concepts/stack_components",
        "https://docs.zenml.io/concepts/service_connectors",
        "https://docs.zenml.io/concepts/snapshots",
        "https://docs.zenml.io/concepts/deployment",
        "https://docs.zenml.io/concepts/containerization",
        "https://docs.zenml.io/concepts/code-repositories",
        "https://docs.zenml.io/concepts/secrets",
        "https://docs.zenml.io/concepts/environment-variables",
        "https://docs.zenml.io/concepts/tags",
        "https://docs.zenml.io/concepts/metadata",
        "https://docs.zenml.io/concepts/models",
        "https://docs.zenml.io/concepts/dashboard-features",
        "https://docs.zenml.io/concepts/templates",
        "https://docs.zenml.io/reference/community-and-content",
        "https://docs.zenml.io/reference/environment-variables",
        "https://docs.zenml.io/reference/llms-txt",
        "https://docs.zenml.io/reference/faq",
        "https://docs.zenml.io/reference/global-settings",
        "https://docs.zenml.io/reference/legacy-docs",
        "https://docs.zenml.io/deploying-zenml",
        "https://cloudapi.zenml.io/",
        "https://docs.zenml.io/user-guides/tutorial/trigger-pipelines-from-external-systems",
        "https://docs.zenml.io/user-guides/tutorial/managing-scheduled-pipelines",
        "http://zenml.io/pro",
        "https://www.zenml.io/privacy-policy",
        "https://github.com/zenml-io/zenml",
        "https://www.gitbook.com/",
        "https://about.gitlab.com/topics/gitops"
    ]
}