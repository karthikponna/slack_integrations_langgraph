{
    "id": "2cecb2cbfef6ae2ae1b69d0bab52c16b",
    "metadata": {
        "id": "2cecb2cbfef6ae2ae1b69d0bab52c16b",
        "url": "https://docs.zenml.io/concepts/environment-variables",
        "title": "Environment Variables | ZenML - Bridging the gap between ML & Ops",
        "properties": {
            "description": "Configuring environment variables.",
            "keywords": null,
            "author": null,
            "og:title": "Environment Variables | ZenML - Bridging the gap between ML & Ops",
            "og:description": "Configuring environment variables.",
            "og:image": "https://docs.zenml.io/~gitbook/ogimage/CElYlpRJfmn9OkSlBvPw",
            "twitter:card": "summary_large_image",
            "twitter:title": "Environment Variables | ZenML - Bridging the gap between ML & Ops",
            "twitter:description": "Configuring environment variables.",
            "twitter:image": "https://docs.zenml.io/~gitbook/ogimage/CElYlpRJfmn9OkSlBvPw"
        }
    },
    "content": "`Ctrl``k`\nGitBook AssistantAsk\nProductResourcesGitHubStart free\nMore\n  * Documentation\n  * Learn\n  * ZenML Pro\n  * Stacks\n  * API Reference\n  * SDK Reference\n  * Changelog\n\n\nGitBook Assistant\nGitBook Assistant\nWorking...Thinking...\nGitBook Assistant\n##### Good afternoon\nI'm here to help you with the docs.\nWhat is this page about?What should I read next?Can you give an example?\n`Ctrl``i`\nAI Based on your context\nSend\n  * Getting Started\n    *     *     *     *     *     *   * Deploying ZenML\n    *     *     *   * Concepts\n    *     *     *     *     *     *     *     *     *     *     *     *     *     *     *   * Reference\n    *     *     *     *     *     * \n\nPowered by GitBook\n  * Configuration levels\n  * Automatic environment variable injection\n  * Configuring environment variables on stack components\n  * Setting environment variables on stacks\n  * Configuring environment variables on pipelines\n  * Setting environment variables on steps\n  * When environment variables are set\n\n\nWas this helpful?\nGitBook AssistantAsk\n  1. Concepts\n\n\nConfiguring environment variables.\nEnvironment variables can be configured to be available at runtime during step execution. ZenML provides two ways to set environment variables:\n  1. **Plain text environment variables** : Configure key-value pairs directly\n  2. **Secrets as environment variables** : Use ZenML secrets where the secret values become environment variables. Check out this page for more information on secret management in ZenML.\n\n\nIf you need environment variables to be available at image built time, check out the containerization documentation for more information.\n## \nConfiguration levels\nEnvironment variables and secrets can be configured at different levels with increasing precedence:\n  1. **Stack components** - Available for all pipelines executed on stacks containing this component\n  2. **Stack** - Available for all pipelines executed on this stack\n  3. **Pipeline** - Available for all steps in this pipeline\n  4. **Step** - Available only for this specific step\n\n\n**Precedence order** : Step configuration overrides pipeline configuration, which overrides stack configuration, which overrides stack component configuration. Additionally, secrets always take precedence over direct environment variables when both are configured with the same key.\n## \nAutomatic environment variable injection\nWhen executing a pipeline, ZenML automatically scans your local environment for any variables that start with the `__ZENML__` prefix and adds them to the pipeline environment. The prefix is removed during this process.\nFor example, if you set:\nCopy```\nexport __ZENML__MY_VAR=my_value\n```\n\nIt will be available in your steps as follows:\nCopy```\nimport os\nfrom zenml import step\n@step\ndef my_step():\n    my_var = os.environ[\"MY_VAR\"]  # \"my_value\"\n```\n\n## \nConfiguring environment variables on stack components\nConfigure environment variables and secrets that will be available for all pipelines executed on stacks containing this component.\nCLI\nPython\nCopy```\n# Configure environment variables\nzenml orchestrator update <ORCHESTRATOR_NAME> --env <KEY>=<VALUE>\n# Remove environment variables (set empty value)\nzenml orchestrator update <ORCHESTRATOR_NAME> --env <KEY>=\n# Attach secrets (secret values become environment variables)\nzenml orchestrator update <ORCHESTRATOR_NAME> --secret <SECRET_NAME_OR_ID>\n# Remove secrets\nzenml orchestrator update <ORCHESTRATOR_NAME> --remove-secret <SECRET_NAME_OR_ID>\n```\n\nCopy```\nfrom zenml import Client\nClient().update_stack_component(\n    name_id_or_prefix=<COMPONENT_NAME_OR_ID>,\n    component_type=<COMPONENT_TYPE>,\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        # Set to `None` to remove from previously configured environment\n        \"<KEY>\": None\n    },\n    add_secrets=[\"<SECRET_NAME_OR_ID>\", \"<SECRET_NAME_OR_ID>\"],\n    remove_secrets=[\"<SECRET_NAME_OR_ID>\"]\n)\n```\n\n## \nSetting environment variables on stacks\nConfigure environment variables and secrets for all pipelines executed on this stack.\nCLI\nPython\nCopy```\n# Configure environment variables\nzenml stack update <STACK_NAME> --env <KEY>=<VALUE>\n# Remove environment variables\nzenml stack update <STACK_NAME> --env <KEY>=\n# Attach secrets\nzenml stack update <STACK_NAME> --secret <SECRET_NAME_OR_ID>\n# Remove secrets\nzenml stack update <STACK_NAME> --remove-secret <SECRET_NAME_OR_ID>\n```\n\nCopy```\nfrom zenml import Client\nClient().update_stack(\n    name_id_or_prefix=<STACK_NAME_OR_ID>,\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        # Set to `None` to remove from previously configured environment\n        \"<KEY>\": None\n    },\n    add_secrets=[\"<SECRET_NAME_OR_ID>\"],\n    remove_secrets=[\"<SECRET_NAME_OR_ID>\"]\n)\n```\n\n## \nConfiguring environment variables on pipelines\nConfigure environment variables and secrets for all steps of a pipeline. See this page for more details on how to configure pipelines.\nCopy```\nfrom zenml import pipeline\n# On the decorator\n@pipeline(\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        \"<KEY>\": \"<VALUE>\"\n    },\n    secrets=[\"<SECRET_NAME_OR_ID>\", \"<SECRET_NAME_OR_ID>\"]\n)\ndef my_pipeline():\n    ...\n# Using the `with_options(...)` method\nmy_pipeline = my_pipeline.with_options(\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        \"<KEY>\": \"<VALUE>\"\n    },\n    secrets=[\"<SECRET_NAME_OR_ID>\", \"<SECRET_NAME_OR_ID>\"]\n)\n```\n\n## \nSetting environment variables on steps\nConfigure environment variables and secrets for individual steps. See this page for more details on how to configure steps.\nCopy```\nfrom zenml import step\n# On the decorator\n@step(\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        \"<KEY>\": \"<VALUE>\"\n    },\n    secrets=[\"<SECRET_NAME_OR_ID>\"]\n)\ndef my_step() -> str:\n    ...\n# Using the `with_options(...)` method\nmy_step = my_step.with_options(\n    environment={\n        \"<KEY>\": \"<VALUE>\",\n        \"<KEY>\": \"<VALUE>\"\n    },\n    secrets=[\"<SECRET_NAME_OR_ID>\", \"<SECRET_NAME_OR_ID>\"]\n)\n```\n\n## \nWhen environment variables are set\nThe timing of when environment variables are set depends on the orchestrator being used:\n  * The Databricks and Lightning orchestrators will set the environment variables right before your step code is being executed\n  * **All other orchestrators** set environment variables already at container startup time\n\n\n**Environment variables from secrets** are always set right before your step code is being executed for security reasons, regardless of the orchestrator.\nPreviousSecretsNextTags\nLast updated 2 months ago\nWas this helpful?\n",
    "summary": "## TL;DR Summary\n\n### Configuring Environment Variables in ZenML\n\nZenML allows the configuration of environment variables at runtime during step execution through two methods:\n1. **Plain Text Environment Variables**: Direct key-value pairs.\n2. **Secrets as Environment Variables**: Use ZenML secrets for sensitive data.\n\n### Configuration Levels\nEnvironment variables can be set at various levels with the following precedence:\n- **Step**: Highest precedence, specific to the step.\n- **Pipeline**: Applies to all steps in the pipeline.\n- **Stack**: Applies to all pipelines in the stack.\n- **Stack Components**: Applies to all pipelines using the component.\n\n### Automatic Injection\nZenML automatically injects environment variables prefixed with `__ZENML__` into the pipeline.\n\n### Setting Environment Variables\n- **On Stack Components**: Use CLI or Python to configure environment variables and secrets.\n- **On Stacks**: Similar configuration methods as stack components.\n- **On Pipelines and Steps**: Configure directly in the pipeline or step decorators.\n\n### Timing of Environment Variables\n- Databricks and Lightning orchestrators set variables before step execution.\n- Other orchestrators set them at container startup, while secrets are set right before execution for security.",
    "content_quality_score": null,
    "child_urls": [
        "https://docs.zenml.io/",
        "https://zenml.io",
        "https://zenml.io/slack",
        "https://cloud.zenml.io/signup",
        "https://docs.zenml.io/user-guides",
        "https://docs.zenml.io/pro",
        "https://docs.zenml.io/stacks",
        "https://docs.zenml.io/api-reference",
        "https://docs.zenml.io/sdk-reference",
        "https://docs.zenml.io/changelog",
        "https://docs.zenml.io/getting-started/installation",
        "https://docs.zenml.io/getting-started/hello-world",
        "https://docs.zenml.io/getting-started/your-first-ai-pipeline",
        "https://docs.zenml.io/getting-started/core-concepts",
        "https://docs.zenml.io/getting-started/system-architectures",
        "https://docs.zenml.io/deploying-zenml/deploying-zenml",
        "https://docs.zenml.io/deploying-zenml/connecting-to-zenml",
        "https://docs.zenml.io/deploying-zenml/upgrade-zenml-server",
        "https://docs.zenml.io/concepts/steps_and_pipelines",
        "https://docs.zenml.io/concepts/artifacts",
        "https://docs.zenml.io/concepts/stack_components",
        "https://docs.zenml.io/concepts/service_connectors",
        "https://docs.zenml.io/concepts/snapshots",
        "https://docs.zenml.io/concepts/deployment",
        "https://docs.zenml.io/concepts/containerization",
        "https://docs.zenml.io/concepts/code-repositories",
        "https://docs.zenml.io/concepts/secrets",
        "https://docs.zenml.io/concepts/environment-variables",
        "https://docs.zenml.io/concepts/tags",
        "https://docs.zenml.io/concepts/metadata",
        "https://docs.zenml.io/concepts/models",
        "https://docs.zenml.io/concepts/dashboard-features",
        "https://docs.zenml.io/concepts/templates",
        "https://docs.zenml.io/reference/community-and-content",
        "https://docs.zenml.io/reference/environment-variables",
        "https://docs.zenml.io/reference/llms-txt",
        "https://docs.zenml.io/reference/faq",
        "https://docs.zenml.io/reference/global-settings",
        "https://docs.zenml.io/reference/legacy-docs",
        "https://docs.zenml.io/concepts",
        "https://docs.zenml.io/concepts/steps_and_pipelines/configuration",
        "https://github.com/zenml-io/zenml",
        "https://www.gitbook.com/",
        "https://github.com/zenml-io/zenml/blob/main/docs/book/component-guide/orchestrators/databricks.md",
        "https://github.com/zenml-io/zenml/blob/main/docs/book/component-guide/orchestrators/lightning.md"
    ]
}